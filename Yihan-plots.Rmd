---
title: "Yihan-plots"
author: "Yihan Shi"
date: "9/27/2021"
output: html_document
---
### Introduction
Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why youâ€™re interested in this question.

### Approach 
Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.


```{r load libraries}
library(tidyverse)
library(ggplot2)
library(cowplot)
```

```{r dataset}
youtube <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv', show_col_types = FALSE)

glimpse(youtube)
```

```{r wrangling_1}
# calcualte percentages for each category
nr <- nrow(youtube)

funny_perc <-  sum(youtube$funny)/nr
show_product_quickly_perc <- sum(youtube$show_product_quickly)/nr
patriotic_perc <-  sum(youtube$patriotic)/nr
celebrity_perc <- sum(youtube$celebrity)/nr
danger_perc <- sum(youtube$danger)/nr
animals_perc <- sum(youtube$animals)/nr
use_sex_perc <- sum(youtube$use_sex)/nr

# make dataframe
percentage_table <- tribble(
  ~category, ~percentage,
  'funny', funny_perc,
  'show_product_quickly', show_product_quickly_perc,
  'patriotic', patriotic_perc,
  'celebrity', celebrity_perc,
  'danger', danger_perc,
  'animals', animals_perc,
  'use_sex', use_sex_perc
)

percentage_table
```

```{r plotting_percentage_overall}
ggplot(percentage_table, aes(x = category, y = percentage)) + 
  geom_col() + 
  scale_colour_brewer(palette = "Pastel1")
```

```{r wrangling_function}
# create compare for different categories

create_compare <- function(varname, full_data) {
  full_data <- full_data %>% 
    drop_na({{varname}}, like_count, view_count, dislike_count, comment_count) %>% 
    mutate(avg_like = like_count / view_count,
           avg_dislike = dislike_count / view_count,
           avg_engage = comment_count / view_count,
           feature = as_label(enquo(varname))) %>% 
    select({{varname}}, avg_like, avg_dislike, avg_engage, feature) %>%
    rename(val = as_label(enquo(varname)))
  return(full_data)
}
```
(Function was written with the help of TA)

```{r}
all_compare <- rbind(create_compare(funny, youtube),
                     create_compare(danger, youtube),
                     create_compare(show_product_quickly, youtube),
                     create_compare(patriotic, youtube),
                     create_compare(celebrity, youtube),
                     create_compare(animals, youtube),
                     create_compare(use_sex, youtube))
```


```{r plotting compare}
like_plot <- ggplot(all_compare, aes(x = avg_like, y = feature, color = val)) +
  geom_boxplot()

dislike_plot <- ggplot(all_compare, aes(x = avg_dislike, y = feature, color = val)) +
  geom_boxplot()

engage_plot <- ggplot(all_compare, aes(x = avg_engage, y = feature, color = val)) +
  geom_boxplot()

like_plot
dislike_plot
engage_plot
```

### Analysis
provide the code that generates your plots. Use scale functions to provide nice axis labels and guides. 

### Discussion

