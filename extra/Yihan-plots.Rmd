---
title: "Yihan-plots"
author: "Yihan Shi"
date: "9/27/2021"
output: github_document
---
### Introduction
Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why youâ€™re interested in this question.

### Approach 
Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.


```{r load libraries}
library(tidyverse)
library(ggplot2)
library(scales)
```

```{r dataset}
youtube <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv', show_col_types = FALSE)

glimpse(youtube)
```


```{r wrangling_function}
# create compare function for different categories

create_compare <- function(varname, full_data) {
  full_data <- full_data %>% 
    drop_na({{varname}}, like_count, view_count, dislike_count, comment_count) %>% 
    mutate(like = like_count / view_count,
           dislike = dislike_count / view_count,
           engage = comment_count / view_count,
           feature = as_label(enquo(varname))) %>% 
    select({{varname}}, like, dislike, engage, feature, year) %>%
    rename(val = as_label(enquo(varname)))
  return(full_data)
}
```
(Function was written with the help of TA)

```{r create new table}
all_compare <- rbind(create_compare(funny, youtube),
                     create_compare(danger, youtube),
                     create_compare(show_product_quickly, youtube),
                     create_compare(patriotic, youtube),
                     create_compare(celebrity, youtube),
                     create_compare(animals, youtube),
                     create_compare(use_sex, youtube))
```


```{r plotting compare}
like_plot <- ggplot(all_compare, aes(x = like, y = feature, color = val)) +
  geom_boxplot(aes(color = val)) + 
  labs(title = "The rate of audience hitting 'like' for Youtube Superbowl Commercials\nOver all years from 2000 to 2020",
       subtitle = "By video features",
       x = "Ratio of like over views",
       y = "Average rate of likes over views") +
  scale_color_manual("Feature", values = c("#0047AB", "#FF0000")) +
  theme_minimal() 

dislike_plot <- ggplot(all_compare, aes(x = dislike, y = feature, color = val)) +
  geom_boxplot()

engage_plot <- ggplot(all_compare, aes(x = engage, y = feature, color = val)) +
  geom_boxplot()

like_plot
dislike_plot
engage_plot
```



```{r create new dataset for facetting}
feature_over_years <- all_compare %>% 
  group_by(year, feature, val) %>% 
  summarise(mean_like = mean(like),
            mean_engage = mean(engage))
```


```{r}
ggplot(feature_over_years, aes(x = year, y = mean_like)) + 
  geom_line(aes(color = val)) + 
  labs(title = "The rate of audience hitting 'like' for Youtube Superbowl Commercials\nEach year from 2000 to 2020",
       subtitle = "By video features and year",
       x = "Year",
       y = "Average ratio of likes over views") +
  facet_wrap(feature ~ .) + 
  scale_color_manual("Feature", values = c("#808080", "#FF0000")) +
  scale_y_continuous(labels = label_percent(accuracy = NULL, scale = 100, prefix = "",
  suffix = "%", big.mark = " ", decimal.mark = ".", trim = TRUE)) +
  theme_minimal() 
```


```{r}
ggplot(feature_over_years, aes(x = year, y = mean_engage)) + 
  geom_line(aes(color = val)) + 
  facet_wrap(feature ~ .)
```



### Analysis
provide the code that generates your plots. Use scale functions to provide nice axis labels and guides. 

### Discussion
The year variable used here denotes the Superbowl year where the commercial was 
shown. However, some commercials have a different published date on Youtube.
Furthermore, the youtube videos have been collected from random Youtube users 
instead of influncers or offial commercial accounts. Therefore, the views, likes,
and engagement also depend on the account itself.
